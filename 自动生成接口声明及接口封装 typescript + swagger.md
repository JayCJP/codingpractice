
> ğŸ’¡  æ ¹æ® [é—å¿˜æ›²çº¿](https://baike.baidu.com/item/%E9%81%97%E5%BF%98%E6%9B%B2%E7%BA%BF/7278665?fr=aladdin)ï¼šå¦‚æœæ²¡æœ‰è®°å½•å’Œå›é¡¾ï¼Œ6å¤©åä¾¿ä¼šå¿˜è®°75%çš„å†…å®¹
      è¯»ä¹¦ç¬”è®°æ­£æ˜¯å¸®åŠ©ä½ è®°å½•å’Œå›é¡¾çš„å·¥å…·ï¼Œä¸å¿…æ‹˜æ³¥äºå½¢å¼ï¼Œå…¶æ ¸å¿ƒæ˜¯ï¼šè®°å½•ã€ç¿»çœ‹ã€æ€è€ƒ
## æœ¬æ–‡å¹²è´§

- pont-engine ä½¿ç”¨ä»‹ç»
- è§£æ swagger è‡ªåŠ¨ç”Ÿæˆ æ¥å£å“åº”ä½“ å£°æ˜æ–‡ä»¶
- è‡ªå®šä¹‰ä»£ç ç‰‡æ®µ é«˜åº¦è‡ªç”±å°è£…
- è‡ªåŠ¨å¯¼å‡º api æ¨¡å—æä¾›å…¨å±€è°ƒç”¨
- è‡ªåŠ¨ç”Ÿæˆæ¥å£æ³¨é‡Š

## å‰è¨€

æœ€è¿‘åœ¨æ—¥å¸¸çš„å¼€å‘å·¥ä½œä¸­ï¼Œå‘ç°äº†ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯åœ¨å¯¹æ¥åç«¯çš„æ¥å£æ—¶ï¼Œå‘ç°ç»å¸¸è¦å»ç¿»é˜…æ¥å£æ–‡æ¡£ï¼ŒæŸ¥åˆ°å¯¹åº”çš„æ¥å£ä»¥åŠè¿”å›å€¼ï¼Œè¿™ä¸ªæ“ä½œçœ‹ä¸Šå»å¾ˆæ­£å¸¸æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯æ²¡æœ‰ä»£ç æç¤ºç¡®å®ä¸æ˜¯å¾ˆæ–¹ä¾¿ã€‚

é€šå¸¸åœ¨é¡¹ç›®çš„è®¾è®¡ä¸­éƒ½ä¼šå¯¹æ¥å£è¯·æ±‚åšä¸€ä¸ªå°è£…å¤„ç†ï¼Œç›®çš„å°±æ˜¯ç»Ÿä¸€è§„èŒƒï¼Œç»Ÿä¸€ç®¡ç†ç»´æŠ¤ï¼Œæ–¹ä¾¿æ‹“å±•å’Œè¿­ä»£ã€‚

  å¸¸è§çš„å°±æ˜¯åœ¨é¡¹ç›®çš„ src/api æ–‡ä»¶å¤¹ä¸­ æ·»åŠ æ¥å£é…ç½®æ–‡ä»¶ ä»¥åŠæŒ‰æ¨¡å—æ·»åŠ æ¥å£çš„å°è£…å¦‚ä¸‹é¢è¿™ä¸ªç®€å•çš„å®ç°ï¼Œ å½“ä½ åœ¨ä¸šåŠ¡ä¸­æƒ³è¦è¯·æ±‚ä¸€ä¸ª page åˆ—è¡¨çš„æ—¶å€™ï¼Œéœ€è¦è‡ªå·±å®šä¹‰è¯·æ±‚å‚æ•°çš„ç±»å‹ä»¥åŠæ¥å£å“åº”çš„ç±»å‹ã€‚è‡ªå·±æ‰‹å†™ç±»å‹è¿™ä¸ªè¿‡ç¨‹å°±ä¼šæ˜¾å¾—å¾ˆç¹çä¸”éå¸¸è€—æ—¶ã€‚å¦‚æœæ¥å£å¤šçš„æ—¶å€™é‚£ç®€ç›´å°±æ˜¯ç¾éš¾ï¼Œæœ‰æ²¡æœ‰ä¸€ç§å·¥å…·å¯ä»¥è‡ªåŠ¨å¸®æˆ‘ä»¬æ¥å®Œæˆæ¥å£çš„ç±»å‹ç¼–å†™ è¿™ä»¶äº‹å‘¢ï¼Ÿ æ¥ä¸‹æ¥ç»™å¤§å®¶ç®€å•ä»‹ç»ä¸€ä¸‹

  é˜¿é‡Œå¼€æºçš„å·¥å…·  Pont å¯ä»¥æ¥å¸®æˆ‘ä»¬å®Œæˆè¿™ä»¶äº‹æƒ…ï¼Œå¤§å¤§èŠ‚çœäº†å¯¹æ¥æ¥å£çš„æ—¶é—´ã€‚


```typescript
// src/api/http.ts  å…¬å…±çš„ http è¯·æ±‚ axios å°è£…
class Http {
  // è¯·æ±‚ç±»å‹
  post<T, U>(url: string, data: U, config?: AxiosRequestConfig) {
    return this.handleResponse<T>({
      url: url,
      method: 'POST',
      data: data,
      ...config
    })
  }
  get<T, U>(url: string, data: U, config?: AxiosRequestConfig): Promise<T>
  // è¯·æ±‚æ–¹æ³•
  handleResponse<T>(config: AxiosRequestConfig): Promise<T>
}
  
  const httpReq = new Http({
    timeout: 5000
  })
  
  // è¯·æ±‚æ–¹å¼å°è£… (T å®šä¹‰æ¥å£æ”¾å›çš„æ•°æ®å®ä½“, U å®šä¹‰æ¥å£å…¥å‚çš„ç»“æ„)
  export function post<T, U>(url: string, data: U, config?: AxiosRequestConfig) {
    return httpReq.post<T, U>(url, data, config)
  }

// ----------------------  åˆ†å‰²çº¿ ----------------------------- //

// src/api/mods/xxx.ts  å°è£…æ¥å£å¯¹åº”çš„æ–¹æ³•

interface getPageParams {
  page: number
  size: number
}
interface Item {
  id: number
  title: string
}
// è·å–åˆ—è¡¨
export function getPage(data: getPageParams) {
  return post<Item[], getPageParams>('/api/getpage', data)
}

```
## Pont é“¾æ¥å‰åç«¯

pont åœ¨æ³•è¯­ä¸­æ˜¯â€œæ¡¥â€çš„æ„æ€ï¼Œå¯“æ„ç€å‰åç«¯ä¹‹é—´çš„æ¡¥æ¢ã€‚Pont æŠŠ swaggerã€rapã€dip ç­‰å¤šç§æ¥å£æ–‡æ¡£å¹³å°ï¼Œè½¬æ¢æˆ Pont å…ƒæ•°æ®ã€‚Pont åˆ©ç”¨æ¥å£å…ƒæ•°æ®ï¼Œå¯ä»¥é«˜åº¦å®šåˆ¶åŒ–ç”Ÿæˆå‰ç«¯æ¥å£å±‚ä»£ç ï¼Œæ¥å£ mock å¹³å°å’Œæ¥å£æµ‹è¯•å¹³å°ã€‚å…¶ä¸­ swagger æ•°æ®æºï¼ŒPont å·²ç»å®Œç¾æ”¯æŒã€‚å¹¶åœ¨ä¸€äº›å¤§å‹é¡¹ç›®ä¸­ä½¿ç”¨äº†è¿‘ä¸¤å¹´ï¼Œå„ç§é«˜åº¦å®šåˆ¶åŒ–éœ€æ±‚éƒ½å¯ä»¥æ»¡è¶³ã€‚

ç®€å•çš„æ¥è¯´ å°±æ˜¯é€šè¿‡è§£æ swagger çš„ json æ•°æ®ï¼Œè·å–åˆ°æ¥å£çš„åœ°å€ã€å…¥å‚å’Œè¿”å›å€¼ï¼Œä»è€Œæ ¹æ®è¿™äº›å‚æ•° ç”Ÿæˆè‡ªå®šä¹‰çš„ä»£ç å°è£…ã€‚æœ‰ç‚¹æ„æ€â€¦

æ—¢ç„¶å®˜æ–¹ä»‹ç»å¾—è¿™ä¹ˆå¼ºå¤§ï¼Œ é‚£æˆ‘ä»¬æ¥çœ‹çœ‹æ€ä¹ˆè§£å†³å‰è¨€ä¸­æåˆ°çš„é—®é¢˜ï¼Œæœ¬æ–‡ç»™å¤§å®¶ä»‹ç»åœ¨ vue ä¸­çš„å®è·µï¼Œåœ¨æ­¤ä¹‹å‰å»ºè®®å…ˆç®€å•è¿‡ä¸€ä¸‹å®˜æ–¹ä»‹ç»æ–‡æ¡£ã€‚

GitHubåœ°å€ï¼š[https://github.com/alibaba/pont](https://github.com/alibaba/pont)

ç¤ºä¾‹ï¼š[https://github.com/alibaba/pont/tree/master/examples](https://github.com/alibaba/pont/tree/master/examples)ï¼ˆå®˜æ–¹åªæœ‰ react ç‰ˆæœ¬ï¼‰

## å¸Œæœ›å®ƒèƒ½ç»™æˆ‘ä»¬è§£å†³

- è‡ªåŠ¨ç”Ÿæˆæ¥å£å£°æ˜æ–‡ä»¶
- è‡ªåŠ¨ç”Ÿæˆæ¥å£å°è£…ä»£ç 
- è‡ªåŠ¨ç”Ÿæˆæ¥å£æ•°æ®çš„åŸºç±»
- è‡ªåŠ¨ç”Ÿæˆæ¥å£ä»£ç æ³¨é‡Š

## é‚£å¼€å§‹å§
  å…ˆè®²è®²éœ€è¦ç”¨åˆ°çš„åŠŸèƒ½
### é…ç½®æ–‡ä»¶

1. **originUrl**: æ¥å£å¹³å°æä¾›çš„æ•°æ®æºï¼ˆè¿æ¥ä¸€èˆ¬åœ¨swagger æ ‡é¢˜ä¸‹é¢ï¼‰
1. **templatePath**ï¼šè‡ªå®šä¹‰ç”Ÿæˆä»£ç æ¨¡ç‰ˆçš„æ–‡ä»¶
1. **transformPath**ï¼šå¯ä»¥å¯¹swaggeræ•°æ®æºé¢„å¤„ç†
1. **outDir**ï¼šæ–‡ä»¶å¯¼å‡ºçš„ç›®å½•
1. **prettierConfig**ï¼šå–œé—»ä¹è§çš„ ä»£ç æ ¼å¼åŒ–é…ç½®
1. **templateType**ï¼šå®˜æ–¹æä¾›äº† fetch å’Œ hook çš„ä»£ç ç”Ÿæˆæ¨¡æ¿ï¼Œä½†è¿™é‡Œæˆ‘ä»¬é€‰æ‹©è‡ªå·±ç”Ÿæˆ
1. **mocks**ï¼šå–œé—»ä¹è§çš„ mocks æ•°æ®

å®˜æ–¹æœ‰éå¸¸è¯¦ç»†çš„ä»‹ç» æ›´å¤šå­—æ®µè§£é‡Š-> [ä¼ é€é—¨](https://github.com/alibaba/pont/blob/master/docs/pontConfig.md)

```json
{
  "originUrl": "/path/to/swagger.json",
  "templateType": "fetch",
  "templatePath": "./path/to/pontTemplate",
  "transformPath": "./path/to/transformPath",
  "outDir": "./src/api",
  "mocks": {
    "enable": false
  },
  "prettierConfig": {
    "tabWidth": 2,
    "semi": false,
    "singleQuote": true,
    "bracketSpacing": true,
    "arrowParens": "avoid",
    "trailingComma": "none",
    "proseWrap": "never",
    "printWidth": 300,
    "htmlWhitespaceSensitivity": "ignore",
    "endOfLine": "auto"
  }
}
```
### è‡ªå®šä¹‰è§£æ swagger çš„æ¥å£æ•°æ®

å½“æˆ‘ä»¬æ‹¿åˆ°åç«¯çš„ swagger é“¾æ¥æ—¶ï¼Œä¸€èˆ¬æ˜¯åŒ…å«æ•´ä¸ªé¡¹ç›®çš„æ¥å£ã€‚å¯èƒ½æœ‰å‰å°çš„åå°çš„ï¼Œå¦‚æœä¸€é”®ç”Ÿæˆå°±åŒ…å«ä¸€äº›æˆ‘ä»¬ä¸å¿…è¦çš„æ¥å£ä¿¡æ¯å’Œå†—ä½™ä»£ç ï¼Œ æ‰€ä»¥ pont ç»™æˆ‘ä»¬æä¾›äº†è¿‡æ»¤ swagger æ¨¡ç‰ˆæ•°æ®çš„ api transformPathï¼Œæˆ‘ä»¬é€šè¿‡è¿™ä¸ªé…ç½® export ä¸€ä¸ªè‡ªå®šä¹‰å¤„ç†æ•°æ®çš„æ–¹æ³•æ¥å®Œæˆæˆ‘ä»¬çš„è‡ªå®šä¹‰æ“ä½œã€‚è¿™æ ·å°±å¯ä»¥æŒ‰æˆ‘ä»¬çš„æ„æ„¿æ¥é€‰æ‹©æƒ³è¦çš„æ¨¡å—ã€‚

modï¼ŒæŒ‡çš„æ˜¯æ¥å£æ¨¡å—ï¼Œä¸€ä¸ª mod ä¸‹å¯ä»¥æœ‰Nä¸ªæ¥å£ï¼Œä¸€èˆ¬å¯¹åº”çš„æ˜¯åç«¯çš„æ§åˆ¶å™¨ã€‚

```javascript
// transfrom.ts æ ¹æ® Mod.nameè¿›è¡Œè¿‡æ»¤
import { StandardDataSource } from 'pont-engine'
const useMods = ['æ¨¡å—A', 'æ¨¡å—B', 'æ¨¡å—B']

// ä»åŸæ•°æ®ä¸­è¿‡æ»¤æˆ‘ä»¬æ‰€éœ€è¦çš„æ¥å£æ¨¡å—
export default function transform(data: StandardDataSource) {
  // å–åˆ°æ‰€éœ€è¦çš„ mods å’Œ baseClass
  const { mods, baseClasses } = filterModsAndBaseClass(useMods, data)
  data.mods = mods
  data.baseClasses = baseClasses
  // è¿”å›ç»™ pontï¼Œå®ƒå°†åªä¼šå¤„ç†è¿™äº›æ¨¡å—æ•°æ®
  return data
}

/**
 * è¿‡æ»¤modåŠæ‰€ä¾èµ–çš„baseClass
 * @param filterMods Mod.nameæ•°ç»„
 * @param data StandardDataSource
 */
function filterModsAndBaseClass(filterMods: string[], data: StandardDataSource) {
  const mods = data.mods.filter(mod => {
    const pickOne = filterMods.includes(mod.name)
    pickOne && console.log('æ¨¡å—: ' + mod.name)
    return pickOne
  })
  // è·å–æ‰€æœ‰ typeName (å®ä½“çš„åç§°)
  let typeNames = JSON.stringify(mods).match(/"typeName":".+?"/g)

  typeNames = Array.from(new Set(typeNames)) // å»é‡
    // å–typeNameçš„å€¼
    .map(item => item.split(':')[1].replace(/"/g, ''))

  // è¿‡æ»¤ baseClasses (æ ¹æ®å®ä½“åç§°ç”Ÿæˆbaseclass)
  const baseClasses = data.baseClasses.filter(cls => typeNames && typeNames.includes(cls.name))

  return { mods, baseClasses }
}
```
###  è‡ªå®šä¹‰ç”Ÿæˆå±äºè‡ªå·±çš„æ¥å£å°è£…

åœ¨æ¯ä¸ªäººçš„é¡¹ç›®å®è·µä¸­éƒ½ä¼šæ ¹æ®è‡ªå·±çš„ä¸šåŠ¡éœ€è¦å»å°è£…è‡ªå·±çš„ http æ¥å£è¯·æ±‚ï¼Œæ¯”å¦‚å¸¸è§çš„ axio å’Œ fetchï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°†æŒ‰ç…§ä¸Šæ–‡ å‰è¨€ä¸­æåˆ°çš„å°è£…æ ¼å¼æ¥ç”Ÿæˆæ¥å£ä»£ç ã€‚

åˆ†æä¸€ä¸‹ ä¸‹é¢è¿™ä¸ªä»£ç ç‰‡æ®µæˆ‘ä»¬éœ€è¦ç”Ÿæˆé‚£äº›éƒ¨åˆ†æ‰èƒ½ç»„æˆä¸€ä¸ª å®Œæ•´çš„æ¥å£å°è£…

   1. éœ€è¦å®šä¹‰ä¸€ä¸ªæ–¹æ³•å…¥å‚çš„æ¥å£ç±»å‹ `getPageParams`
   1. éœ€è¦å®šä¹‰ä¸€ä¸ª api è¿”å›çš„æ•°æ®æ ¼å¼æ¥å£ `Item`
   1. ä¸€ä¸ªæ–¹æ³•å `getPage` å‚æ•°å `getPageParams` 
   1. æ¥å£è¯·æ±‚ç±»å‹ `post` æ¥å£è·¯å¾„ `/api/getpage`
```typescript
interface getPageParams {
  page: number
  size: number
}
interface Item {
  id: number
  title: string
}
// éœ€è¦ä¸€ä¸ªæ–¹æ³•å å‚æ•°å
export function getPage(data: getPageParams) {
  return post<Item[], getPageParams>('/api/getpage', data)
}
```
æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™6ä¸ªå­—æ®µï¼Œæ˜¯æˆ‘ä»¬å¸Œæœ›å®ƒèƒ½å¤Ÿï¼Œå¸®æˆ‘ä»¬è‡ªåŠ¨çš„ç”Ÿæˆ å„ç§æ–¹æ³•åï¼Œå…¥å‚å’Œè¿”å›ç»“æœã€‚è¿™æ ·å°±å¯ä»¥æ ¹æ®ä¸åŒçš„æ¥å£æ¥ç”Ÿæˆä¸åŒçš„ä»£ç å°è£…ä»£ç ï¼Œç„¶åå†å°†ä»–ä»¬æŒ‰æ¨¡å—ä¸€ä¸ªä¸ªå†™å…¥åˆ°æˆ‘ä»¬é¡¹ç›®çš„ `src/api`ä¹‹ä¸­ã€‚


æœªå®Œå¾…ç»­...


#### 
## è¸©å‘è®°å½•

1. è‡ªå®šä¹‰ FileStructures 

åœ¨å®˜æ–¹çš„ [customizedPont.md](https://github.com/alibaba/pont/blob/master/docs/customizedPont.md) ä»‹ç»ä¸­ export ä¸€ä¸ª MyFileStructures å³å¯ é‡å†™ FileStructures çš„æ–¹æ³•ï¼Œä½†åœ¨ 1.3.3 çš„ç‰ˆæœ¬ä¸­å¹¶ä¸ç”Ÿæ•ˆ, é€šè¿‡æŸ¥çœ‹æºç å‘ç° Manager ç±»ä¸­çš„ setFilesManager å–å€¼æ˜¯ FileStructures å¹¶é  MyFileStructures æ‰€ä»¥ä¸‹é¢è¿™ä¸ªå†™æ³•æ˜¯é”™è¯¯çš„ å¥½å®¶ä¼™å¯ä»¥æ issue äº†
```javascript
// pontTransfrom.ts  æ–‡æ¡£æ¨èå†™æ³• 
export class MyFileStructures extends FileStructures {}

// å®é™…æºç  manage.ts è§£æä»£ç æ—¶ ç»“æ„å–å€¼ä¸º FileStructures
setFilesManager() {
  this.report('æ–‡ä»¶ç”Ÿæˆå™¨åˆ›å»ºä¸­...')
  const { default: Generator, FileStructures: MyFileStructures } = getTemplate(
    this.currConfig.templatePath,
    this.currConfig.templateType
  )
  // å…¶ä»–æºç  .... 
}

```
æ›´æ­£å¦‚ä¸‹
```javascript
import * as Pont from 'pont-engine'
export class FileStructures extends Pont.FileStructures {}
```


